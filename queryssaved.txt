SELECT 

(SELECT p.nick FROM players p WHERE p.id = '00000000-0000-0000-0000-000000000101') AS ResultadosPara,

l.name AS liga, t.name AS TORNEO, g.id AS GameID, 

CASE
 WHEN g.player1 = '00000000-0000-0000-0000-000000000101' THEN 
(SELECT p.nick FROM players p WHERE p.id = g.player2)
 WHEN g.player2 = '00000000-0000-0000-0000-000000000101' THEN 
(SELECT p.nick FROM players p WHERE p.id = g.player1)
END AS OPONENT,

CASE
 WHEN (g.player1 = '00000000-0000-0000-0000-000000000101'AND g.match1 = '1') THEN 'won'
 WHEN (g.player1 = '00000000-0000-0000-0000-000000000101'AND g.match1 = '2') THEN 'lost'
 WHEN (g.player2 = '00000000-0000-0000-0000-000000000101'AND g.match1 = '1') THEN 'lost'
 WHEN (g.player2 = '00000000-0000-0000-0000-000000000101'AND g.match1 = '2') THEN 'won'
 WHEN g.match1 = '0' THEN 'tie'
END AS match1,

CASE
 WHEN (g.player1 = '00000000-0000-0000-0000-000000000101'AND g.match2 = '1') THEN 'won'
 WHEN (g.player1 = '00000000-0000-0000-0000-000000000101'AND g.match2 = '2') THEN 'lost'
 WHEN (g.player2 = '00000000-0000-0000-0000-000000000101'AND g.match2 = '1') THEN 'lost'
 WHEN (g.player2 = '00000000-0000-0000-0000-000000000101'AND g.match2 = '2') THEN 'won'
 WHEN g.match2 = '0' THEN 'tie'
END AS match2,

CASE
 WHEN (g.player1 = '00000000-0000-0000-0000-000000000101'AND g.match3 = '1') THEN 'won'
 WHEN (g.player1 = '00000000-0000-0000-0000-000000000101'AND g.match3 = '2') THEN 'lost'
 WHEN (g.player2 = '00000000-0000-0000-0000-000000000101'AND g.match3 = '1') THEN 'lost'
 WHEN (g.player2 = '00000000-0000-0000-0000-000000000101'AND g.match3 = '2') THEN 'won'
 WHEN g.match3 = '0' THEN 'tie'
END AS match3,

CASE
 WHEN (g.player1 = '00000000-0000-0000-0000-000000000101'AND g.result = '1') THEN 'won'
 WHEN (g.player1 = '00000000-0000-0000-0000-000000000101'AND g.result = '2') THEN 'lost'
 WHEN (g.player2 = '00000000-0000-0000-0000-000000000101'AND g.result = '1') THEN 'lost'
 WHEN (g.player2 = '00000000-0000-0000-0000-000000000101'AND g.result = '2') THEN 'won'
 WHEN g.result = '0' THEN 'tie'
END AS gameResult



FROM players p
INNER JOIN
games g
ON (g.player1 = p.id)
INNER JOIN
tournaments t
ON (g.tournamentid = t.id)
INNER JOIN
leagues l
ON (t.leagueid = l.id)
WHERE g.player1 = '00000000-0000-0000-0000-000000000101'
OR
g.player2 = '00000000-0000-0000-0000-000000000101'
;